<div id="colorlib-container">
    <div class="container">
        <div class="box1">
            <input name="address" id="address" type="text" class="form-control" value="" placeholder="Address">
            <div id="map"></div>
        </div>
    </div>
</div>

<script>
    var userLatitude = {{{ user.latitude }}}, userLongitude = {{{ user.longitude }}};

    function initMap() {
        var userLocation = { lat: userLatitude, lng: userLongitude };

        var map = new google.maps.Map(document.getElementById('map'), { zoom: 16 });
        var marker = new google.maps.Marker(
            {
                map: map,
                draggable: true,
                animation: google.maps.Animation.DROP,
                position: userLocation,
            }
        );

        var bounds = new google.maps.LatLngBounds();
        bounds.extend(marker.position);
        map.fitBounds(bounds);

        google.maps.event.addListener(marker, 'dragend', function () {
            geocodePosition(marker.getPosition());
        });

        function geocodePosition(pos) {
            geocoder = new google.maps.Geocoder();
            geocoder.geocode(
                {
                    latLng: pos
                },
                function (results, status) {
                    if (status == google.maps.GeocoderStatus.OK) {
                        $("#address").val(results[0].formatted_address);
                    }
                    else {
                        $("#mapErrorMsg").val('Cannot determine address at this location.' + status);
                    }
                }
            );
        }
    }
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCg3Y-44lgOHZmGOV9TXTDxJ2vb2e2R_Cg&callback=initMap" async
    defer></script>